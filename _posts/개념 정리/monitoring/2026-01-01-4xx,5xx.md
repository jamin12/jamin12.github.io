---
layout: post
title: "4xx, 5xx rate"
date: 2026-01-01
categories: [개념정리, monitoring]
tags: [4xx/5xx rate]
---

서버 장애 모니터링에서 가장 흔히 보는 지표는 **에러 비율(4xx, 5xx)** 이다.
하지만 비율 지표만으로는 실제 장애 여부를 정확히 판단하기 어렵다.
실제 운영 환경에서는 **에러 비율 + 전체 트래픽(RPS) + 5xx 절대량(RPS)** 을 함께 봐야 한다.

이번에 설정한 지표들은 이러한 착시를 피하고, **실제 장애 규모와 원인**을 구분하기 위해 구성되었다.

## 4xx / 5xx 비율의 의미

전체 HTTP 요청 중 특정 상태 코드가 차지하는 **비중(%)**을 나타낸다.

* **4xx 비율**
  전체 요청 중 클라이언트 오류(400~499)가 차지하는 비율
  → 잘못된 요청, 인증/권한 문제, API 계약 변경, 클라이언트 버그 등을 판단

* **5xx 비율**
  전체 요청 중 서버 오류(500~599)가 차지하는 비율
  → 서버 내부 문제, 인프라/리소스 병목 가능성을 판단

비율은 “얼마나 자주 실패하는가”를 보여주지만,
**얼마나 많이 실패하는지는 알려주지 않는다.**

## 5xx Error RPS의 의미

**최근 1분 기준으로 발생한 5xx 서버 오류의 초당 발생 건수(RPS)** 를 나타낸다.

* 비율이 아닌 **절대적인 장애량**
* 실제로 사용자에게 영향을 주는 오류 규모를 직접적으로 보여주는 지표

5xx 비율이 높더라도 5xx RPS가 거의 0이면 실질적인 장애가 아닐 수 있고,
5xx 비율이 낮아도 5xx RPS가 높으면 실제 장애로 판단해야 한다.

## 전체 요청 RPS의 역할

현재 서버가 처리 중인 전체 트래픽 규모를 나타낸다.

트래픽이 많은 상황인지 저트래픽 구간에서 비율이 왜곡되고 있는지를 판단하는 기준 지표다.

에러 지표는 반드시 전체 RPS와 함께 해석해야 한다.

## 세 가지를 함께 보는 이유

비율 지표는 항상 상대적이다.
트래픽이 줄어들면 에러가 1건만 발생해도 비율은 급격히 상승한다.

반대로 트래픽이 매우 많은 상황에서는
낮은 비율이라도 실제 에러 수는 심각할 수 있다.

따라서 다음 조합이 필요하다.

* **전체 RPS**: 현재 부하 수준
* **4xx / 5xx 비율**: 실패의 성격과 비중
* **5xx RPS**: 실제 장애 규모

## 감지 패턴

### 상황 A: 비율 착시

* 전체 RPS 매우 낮음
* 5xx 비율 100%
* 5xx RPS ≈ 0

저트래픽 구간에서 발생한 단발성 오류
실질적 장애 아님

### 상황 B: 클라이언트 문제

* 전체 RPS 정상
* 4xx 비율 상승
* 5xx 지표 안정

API 계약 변경, 인증 문제, 잘못된 호출 가능성
서버 자체 문제는 아님

### 상황 C: 서버 장애 전조

* 전체 RPS 정상 또는 증가
* 5xx 비율 점진적 상승
* 5xx RPS 증가 시작

일부 요청에서 서버 오류 발생
DB, 외부 API, 커넥션 풀, 스레드 풀 점검 필요

### 상황 D: 명확한 장애

* 전체 RPS 높음
* 5xx 비율 높음
* 5xx RPS 급증

즉시 대응이 필요한 장애 상황

## 실무 활용 기준

운영 환경에서는 다음 관점으로 해석한다.

* **5xx RPS > 0 지속 발생** → 실제 서버 오류 존재
* **5xx 비율 상승 + RPS 증가** → 장애 가능성 높음
* **4xx 비율만 상승** → 클라이언트 또는 계약 문제

비율은 신호이고, **5xx RPS는 증거**다.
