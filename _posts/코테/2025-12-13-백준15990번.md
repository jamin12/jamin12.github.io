---
layout: post
title: "백준 15990번 - 가장 긴 감소하는 부분 수열"
date: 2025-12-13 14:20:00 +0900
categories: [코테]
tags: [dp]
math: true
---

## 문제
{% include link-preview.html url="https://www.acmicpc.net/problem/15990" title="백준 15990번 문제" %}

## 풀이

이 문제는 **연속해서 같은 수를 사용할 수 없다**는 점이 핵심입니다. 즉, 현재 값을 만들기 위해 **마지막에 어떤 수를 더했는지**를 알아야 합니다.

$n$을 만들 때, 마지막에 더한 수에 따라 3가지 경우가 존재합니다.

1. **마지막에 1을 더한 경우**
2. **마지막에 2를 더한 경우**
3. **마지막에 3을 더한 경우**

### 점화식 도출
생각보다 간단합니다. "직전과 다른 수를 더해야 한다"는 규칙만 기억하면 됩니다.

* **마지막에 1을 더하는 경우** (`dp[i][1]`)
  * 이전 단계($i-1$)에서 **2**나 **3**으로 끝났어야 합니다.
  * $$DP[i][1] = (DP[i-1][2] + DP[i-1][3]) \% MOD$$

* **마지막에 2를 더하는 경우** (`dp[i][2]`)
  * 이전 단계($i-2$)에서 **1**이나 **3**으로 끝났어야 합니다.
  * $$DP[i][2] = (DP[i-2][1] + DP[i-2][3]) \% MOD$$

* **마지막에 3을 더하는 경우** (`dp[i][3]`)
  * 이전 단계($i-3$)에서 **1**이나 **2**로 끝났어야 합니다.
  * $$DP[i][3] = (DP[i-3][1] + DP[i-3][2]) \% MOD$$

### 정답
$N$을 만드는 방법은 마지막에 1, 2, 3으로 끝나는 모든 경우의 수의 합입니다.
$$Answer = (DP[N][1] + DP[N][2] + DP[N][3]) \ \% \ MOD$$

## 코드

```java
public class Main {
  public static void main(String[] args) {
    try {
      BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
      int n = Integer.parseInt(br.readLine());
      int[] t = new int[n];

      int max = 0;
      for (int i = 0; i < n; i++) {
        int ti = Integer.parseInt(br.readLine());
        max = Math.max(max, ti);
        t[i] = ti;
      }

      long[][] dp = new long[max][3];
      dp[0][0] = 1;
      dp[0][1] = 0;
      dp[0][2] = 0;
      dp[1][0] = 0;
      dp[1][1] = 1;
      dp[1][2] = 0;
      dp[2][0] = 1;
      dp[2][1] = 1;
      dp[2][2] = 1;

      for (int i = 3; i < max; i++) {
        dp[i][0] = (dp[i - 1][1] + dp[i - 1][2]) % 1000000009;
        dp[i][1] = (dp[i - 2][0] + dp[i - 2][2]) % 1000000009;
        dp[i][2] = (dp[i - 3][0] + dp[i - 3][1]) % 1000000009;
      }
      for (int i : t) {
        long sum = Arrays.stream(dp[i - 1]).sum() % 1000000009;
        System.out.println(sum);
      }

    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
```